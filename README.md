# DeepONet for Groundwater (PyTorch)

本项目旨在复现论文 [Taccari et al. (2024)](https://doi.org/10.1016/j.jhydrol.2023.130551) 中基于 DeepONet 的地下水流仿真器。

## 项目背景
原论文使用 **JAX** 框架实现了 2D 抽水试验下地下水流动模拟（E1~E5），内容丰富。本项目尝试将其迁移至 **PyTorch** 框架。

## 复现进展
* **2D 实验 (E1)**：尝试复现论文中的 2D 抽水试验（固定抽水井、稳定流），但未能达到预期精度，模拟结果与参考存在显著偏差。
* **1D 简化测试**：为了更好理解存在的问题，退回 1D 情况进行测试。

## 当前问题
初步测试显示 1D 模拟效果不理想：
* **拟合欠佳**：模拟结果与参考值偏差较大，拟合效果不理想。

## 后续排查
1.  优化 1D 场景下的超参数及数据归一化策略。
---
2026-01-22 更新：1D 拟合取得重大突破通过调整网络拓扑结构，成功解决了模型输出“直线化”的欠拟合问题，1D 场景下的预测精度显著提升。
1. 模型架构调整：
参数配置：将基底维度 (Basis dimension) $p$ 提升至 300。
Branch Net (分支网络)：简化了卷积层级。
实验发现，过深的一维卷积会导致特征信息（梯度信息）丢失。减少卷积层后，特征提取能力更强。
Trunk Net (主干网络)：采用了 5 层全连接层架构（宽度为 $p$），增强了坐标空间到基函数的映射能力。
2. 关键发现：解决梯度消失之前的拟合失败主要是由于特征提取层过深导致的梯度/特征消失。在精简卷积层并调整激活函数后，模型在几分钟内即可完成高效收敛。
3. 拟合效果对比从左至右可以看到模型性能的演进：初步修复后，预测曲线（红色虚线）已能较好地捕捉抽水漏斗的弯曲形态，与参考解（蓝色实线）高度重合。

初始优化效果：

<img src="https://github.com/user-attachments/assets/4eebfa3d-316c-4337-b3ae-dfda6fd55e8c" width="600" />

<img src="https://github.com/user-attachments/assets/b057b700-36ee-447a-bd2b-8cf6e8ad350c" width="600" />
